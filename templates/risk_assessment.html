{% extends 'dashboard_layout.html' %}

{% block title %}{{ _('Investment Risk Profile') }}{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="text-center mb-5">
                <h2 class="fw-bold">{{ _('Investment Risk Profile') }}</h2>
                <p class="text-secondary">{{ _('Please answer the following questions to help us understand your investment goals and risk tolerance. This will take about 5 minutes.') }}</p>
            </div>

            <!-- Stepper Navigation -->
            <div class="risk-stepper d-flex align-items-center justify-content-between mb-5 px-5">
                <div class="step active" id="step-indicator-1">
                    <div class="step-circle">1</div>
                    <span class="ms-2 d-none d-md-block fw-bold">{{ _('Financial Profile') }}</span>
                </div>
                <div class="step-line mx-3"></div>
                <div class="step" id="step-indicator-2">
                    <div class="step-circle">2</div>
                    <span class="ms-2 d-none d-md-block fw-bold">{{ _('Knowledge & Experience') }}</span>
                </div>
                <div class="step-line mx-3"></div>
                <div class="step" id="step-indicator-3">
                    <div class="step-circle">3</div>
                    <span class="ms-2 d-none d-md-block fw-bold">{{ _('Risk Tolerance') }}</span>
                </div>
            </div>

            <div class="card border-0 shadow-sm">
                <div class="card-body p-4 p-md-5">
                    <form method="POST" action="{{ url_for('user.risk_assessment') }}" id="riskForm">
                        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

                        <!-- Step 1: Financial Profile -->
                        <div class="risk-question-group active" id="group-1">
                            <h4 class="mb-4 text-primary">{{ _('Step 1: Your Financial Profile') }}</h4>
                            
                            <div class="mb-4">
                                <label class="form-label fw-bold mb-3">{{ _('1. What is your age range?') }}</label>
                                <div class="btn-group-vertical w-100" role="group">
                                    <input type="radio" class="btn-check" name="q1" id="q1a" value="10" required>
                                    <label class="btn btn-outline-secondary py-3 px-4" for="q1a">{{ _('18-30 (High Capacity)') }}</label>

                                    <input type="radio" class="btn-check" name="q1" id="q1b" value="8">
                                    <label class="btn btn-outline-secondary py-3 px-4" for="q1b">{{ _('31-45') }}</label>

                                    <input type="radio" class="btn-check" name="q1" id="q1c" value="5">
                                    <label class="btn btn-outline-secondary py-3 px-4" for="q1c">{{ _('46-60') }}</label>

                                    <input type="radio" class="btn-check" name="q1" id="q1d" value="2">
                                    <label class="btn btn-outline-secondary py-3 px-4" for="q1d">{{ _('61+ (Low Capacity)') }}</label>
                                </div>
                            </div>

                            <div class="mb-4">
                                <label class="form-label fw-bold mb-3">{{ _('2. What is your approximate annual income?') }}</label>
                                <select class="form-select form-select-lg" name="q2">
                                    <option value="2">{{ _('Less than $50,000') }}</option>
                                    <option value="5">{{ _('$50,000 - $100,000') }}</option>
                                    <option value="8">{{ _('$100,000 - $250,000') }}</option>
                                    <option value="10">{{ _('More than $250,000') }}</option>
                                </select>
                            </div>

                            <div class="d-flex justify-content-end mt-5">
                                <button type="button" class="btn btn-primary btn-lg px-5" onclick="nextStep(2)">{{ _('Next (Step 2)') }} &rarr;</button>
                            </div>
                        </div>

                        <!-- Step 2: Knowledge -->
                        <div class="risk-question-group" id="group-2">
                            <h4 class="mb-4 text-primary">{{ _('Step 2: Your Knowledge & Experience') }}</h4>

                            <div class="mb-4">
                                <label class="form-label fw-bold mb-3">{{ _('6. Investment knowledge level?') }}</label>
                                <div class="btn-group-vertical w-100" role="group">
                                    <input type="radio" class="btn-check" name="q6" id="q6a" value="1" required>
                                    <label class="btn btn-outline-secondary py-3 px-4" for="q6a">{{ _('None (Beginner)') }}</label>

                                    <input type="radio" class="btn-check" name="q6" id="q6b" value="5">
                                    <label class="btn btn-outline-secondary py-3 px-4" for="q6b">{{ _('Basic (Stocks/Bonds)') }}</label>

                                    <input type="radio" class="btn-check" name="q6" id="q6c" value="10">
                                    <label class="btn btn-outline-secondary py-3 px-4" for="q6c">{{ _('Advanced (Derivatives/Crypto)') }}</label>
                                </div>
                            </div>

                            <div class="d-flex justify-content-between mt-5">
                                <button type="button" class="btn btn-outline-secondary btn-lg px-4" onclick="prevStep(1)">&larr; {{ _('Previous') }}</button>
                                <button type="button" class="btn btn-primary btn-lg px-5" onclick="nextStep(3)">{{ _('Next (Step 3)') }} &rarr;</button>
                            </div>
                        </div>

                        <!-- Step 3: Risk Tolerance -->
                        <div class="risk-question-group" id="group-3">
                            <h4 class="mb-4 text-primary">{{ _('Step 3: Your Risk Tolerance') }}</h4>

                            <div class="mb-4">
                                <label class="form-label fw-bold mb-3">{{ _('11. Which statement best describes you?') }}</label>
                                <div class="btn-group-vertical w-100" role="group">
                                    <input type="radio" class="btn-check" name="q11" id="q11a" value="1" required>
                                    <label class="btn btn-outline-secondary py-3 px-4" for="q11a">{{ _('I want to protect my money, even if returns are low.') }}</label>

                                    <input type="radio" class="btn-check" name="q11" id="q11b" value="5">
                                    <label class="btn btn-outline-secondary py-3 px-4" for="q11b">{{ _('I want stable growth with moderate risk.') }}</label>

                                    <input type="radio" class="btn-check" name="q11" id="q11c" value="10">
                                    <label class="btn btn-outline-secondary py-3 px-4" for="q11c">{{ _('I want maximum returns and can accept large losses.') }}</label>
                                </div>
                            </div>

                            <div class="d-flex justify-content-between mt-5">
                                <button type="button" class="btn btn-outline-secondary btn-lg px-4" onclick="prevStep(2)">&larr; {{ _('Previous') }}</button>
                                <button type="submit" class="btn btn-success btn-lg px-5">{{ _('Submit Assessment') }}</button>
                            </div>
                        </div>

                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    function showStep(step) {
        // Hide all groups
        document.querySelectorAll('.risk-question-group').forEach(el => el.classList.remove('active'));
        // Show current group
        document.getElementById('group-' + step).classList.add('active');
        
        // Update stepper UI
        for (let i = 1; i <= 3; i++) {
            const indicator = document.getElementById('step-indicator-' + i);
            indicator.classList.remove('active', 'completed');
            if (i < step) {
                indicator.classList.add('completed');
            } else if (i === step) {
                indicator.classList.add('active');
            }
        }
    }

    function nextStep(step) {
        showStep(step);
        window.scrollTo(0, 0);
    }

    function prevStep(step) {
        showStep(step);
        window.scrollTo(0, 0);
    }
</script>
{% endblock %}